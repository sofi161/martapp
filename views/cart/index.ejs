<%- include('../partials/header') %>

<h2>Your Cart</h2>

<% if(!cart || cart.totalQty === 0){ %>
<p>Your cart is empty. <a href="/products">Shop now</a></p>
<% } else { %>
<table class="cart-table">
  <thead>
    <tr>
      <th>Product</th>
      <th>Qty</th>
      <th>Price</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <% Object.keys(cart.items).forEach(key => { const it = cart.items[key]; %>
    <tr>
      <td><%= it.item.title %></td>
      <td>
        <form action="/cart/update/<%= key %>" method="post">
          <input type="number" name="qty" value="<%= it.qty %>" min="1" />
          <button type="submit">Update</button>
        </form>
      </td>
      <td>₹<%= it.price %></td>
      <td>
        <form action="/cart/remove/<%= key %>" method="post">
          <button type="submit">Remove</button>
        </form>
      </td>
    </tr>
    <% }) %>
  </tbody>
</table>

<p><strong>Total:</strong> ₹<%= cart.totalPrice %></p>
<form action="/orders/checkout" method="post">
  <button type="submit">Checkout</button>
</form>
<% } %> <%- include('../partials/footer') %>
